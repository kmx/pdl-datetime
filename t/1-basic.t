use strict;
use warnings;
use Test::More;
use PDL;
use PDL::DateTime;

####                  datetime             epoch_us   yr   mo   we   dy   dm   dw   ho   mi   se      us          epoch
my @data = (qw/
    0001-01-01T00:00:00.000000   -62135596800000000    1    1    1    1    1    1    0    0    0       0   -62135596800
    0001-01-01T00:00:00.000001   -62135596799999999    1    1    1    1    1    1    0    0    0       1   -62135596800
    0001-01-01T00:00:00.000002   -62135596799999998    1    1    1    1    1    1    0    0    0       2   -62135596800
    0001-01-01T00:00:00.000010   -62135596799999990    1    1    1    1    1    1    0    0    0      10   -62135596800
    0001-01-01T00:00:00.000020   -62135596799999980    1    1    1    1    1    1    0    0    0      20   -62135596800
    0001-01-01T00:00:00.000100   -62135596799999900    1    1    1    1    1    1    0    0    0     100   -62135596800
    0001-01-01T00:00:00.000200   -62135596799999800    1    1    1    1    1    1    0    0    0     200   -62135596800
    0001-01-01T00:00:00.001000   -62135596799999000    1    1    1    1    1    1    0    0    0    1000   -62135596800
    0001-01-01T00:00:00.002000   -62135596799998000    1    1    1    1    1    1    0    0    0    2000   -62135596800
    0001-01-01T00:00:00.010000   -62135596799990000    1    1    1    1    1    1    0    0    0   10000   -62135596800
    0001-01-01T00:00:00.020000   -62135596799980000    1    1    1    1    1    1    0    0    0   20000   -62135596800
    0001-01-01T00:00:00.100000   -62135596799900000    1    1    1    1    1    1    0    0    0  100000   -62135596800
    0001-01-01T00:00:00.200000   -62135596799800000    1    1    1    1    1    1    0    0    0  200000   -62135596800
    0001-01-01T00:00:00.300000   -62135596799700000    1    1    1    1    1    1    0    0    0  300000   -62135596800
    0001-01-01T00:00:00.400000   -62135596799600000    1    1    1    1    1    1    0    0    0  400000   -62135596800
    0001-01-01T00:00:00.490000   -62135596799510000    1    1    1    1    1    1    0    0    0  490000   -62135596800
    0001-01-01T00:00:00.499000   -62135596799501000    1    1    1    1    1    1    0    0    0  499000   -62135596800
    0001-01-01T00:00:00.499900   -62135596799500100    1    1    1    1    1    1    0    0    0  499900   -62135596800
    0001-01-01T00:00:00.499990   -62135596799500010    1    1    1    1    1    1    0    0    0  499990   -62135596800
    0001-01-01T00:00:00.499999   -62135596799500001    1    1    1    1    1    1    0    0    0  499999   -62135596800
    0001-01-01T00:00:00.500000   -62135596799500000    1    1    1    1    1    1    0    0    0  500000   -62135596800
    0001-01-01T00:00:00.500001   -62135596799499999    1    1    1    1    1    1    0    0    0  500001   -62135596800
    0001-01-01T00:00:00.500010   -62135596799499990    1    1    1    1    1    1    0    0    0  500010   -62135596800
    0001-01-01T00:00:00.500100   -62135596799499900    1    1    1    1    1    1    0    0    0  500100   -62135596800
    0001-01-01T00:00:00.501000   -62135596799499000    1    1    1    1    1    1    0    0    0  501000   -62135596800
    0001-01-01T00:00:00.510000   -62135596799490000    1    1    1    1    1    1    0    0    0  510000   -62135596800
    0001-01-01T00:00:00.600000   -62135596799400000    1    1    1    1    1    1    0    0    0  600000   -62135596800
    0001-01-01T00:00:00.700000   -62135596799300000    1    1    1    1    1    1    0    0    0  700000   -62135596800
    0001-01-01T00:00:00.800000   -62135596799200000    1    1    1    1    1    1    0    0    0  800000   -62135596800
    0001-01-01T00:00:00.900000   -62135596799100000    1    1    1    1    1    1    0    0    0  900000   -62135596800
    0001-01-01T00:00:00.980000   -62135596799020000    1    1    1    1    1    1    0    0    0  980000   -62135596800
    0001-01-01T00:00:00.990000   -62135596799010000    1    1    1    1    1    1    0    0    0  990000   -62135596800
    0001-01-01T00:00:00.999800   -62135596799000200    1    1    1    1    1    1    0    0    0  999800   -62135596800
    0001-01-01T00:00:00.999900   -62135596799000100    1    1    1    1    1    1    0    0    0  999900   -62135596800
    0001-01-01T00:00:00.999980   -62135596799000020    1    1    1    1    1    1    0    0    0  999980   -62135596800
    0001-01-01T00:00:00.999990   -62135596799000010    1    1    1    1    1    1    0    0    0  999990   -62135596800
    0001-01-01T00:00:00.999998   -62135596799000002    1    1    1    1    1    1    0    0    0  999998   -62135596800
    0001-01-01T00:00:00.999999   -62135596799000001    1    1    1    1    1    1    0    0    0  999999   -62135596800
    0001-01-01T00:00:01.000000   -62135596799000000    1    1    1    1    1    1    0    0    1       0   -62135596799
    0001-01-01T00:00:01.000001   -62135596798999999    1    1    1    1    1    1    0    0    1       1   -62135596799
    0001-01-01T00:00:01.000002   -62135596798999998    1    1    1    1    1    1    0    0    1       2   -62135596799
    0001-01-01T00:00:01.000010   -62135596798999990    1    1    1    1    1    1    0    0    1      10   -62135596799
    0001-01-01T00:00:01.000020   -62135596798999980    1    1    1    1    1    1    0    0    1      20   -62135596799
    0001-01-01T00:00:01.000100   -62135596798999900    1    1    1    1    1    1    0    0    1     100   -62135596799
    0001-01-01T00:00:01.000200   -62135596798999800    1    1    1    1    1    1    0    0    1     200   -62135596799
    0001-01-01T00:00:01.001000   -62135596798999000    1    1    1    1    1    1    0    0    1    1000   -62135596799
    0001-01-01T00:00:01.002000   -62135596798998000    1    1    1    1    1    1    0    0    1    2000   -62135596799
    0001-01-01T00:00:01.010000   -62135596798990000    1    1    1    1    1    1    0    0    1   10000   -62135596799
    0001-01-01T00:00:01.020000   -62135596798980000    1    1    1    1    1    1    0    0    1   20000   -62135596799
    0001-01-01T00:00:01.100000   -62135596798900000    1    1    1    1    1    1    0    0    1  100000   -62135596799
    0001-01-01T00:00:01.200000   -62135596798800000    1    1    1    1    1    1    0    0    1  200000   -62135596799
    1969-12-31T23:59:58.000000             -2000000 1969   12    1  365   31    3   23   59   58       0             -2
    1969-12-31T23:59:58.500000             -1500000 1969   12    1  365   31    3   23   59   58  500000             -2
    1969-12-31T23:59:58.800000             -1200000 1969   12    1  365   31    3   23   59   58  800000             -2
    1969-12-31T23:59:58.900000             -1100000 1969   12    1  365   31    3   23   59   58  900000             -2
    1969-12-31T23:59:58.980000             -1020000 1969   12    1  365   31    3   23   59   58  980000             -2
    1969-12-31T23:59:58.990000             -1010000 1969   12    1  365   31    3   23   59   58  990000             -2
    1969-12-31T23:59:58.998000             -1002000 1969   12    1  365   31    3   23   59   58  998000             -2
    1969-12-31T23:59:58.999000             -1001000 1969   12    1  365   31    3   23   59   58  999000             -2
    1969-12-31T23:59:58.999800             -1000200 1969   12    1  365   31    3   23   59   58  999800             -2
    1969-12-31T23:59:58.999900             -1000100 1969   12    1  365   31    3   23   59   58  999900             -2
    1969-12-31T23:59:58.999980             -1000020 1969   12    1  365   31    3   23   59   58  999980             -2
    1969-12-31T23:59:58.999990             -1000010 1969   12    1  365   31    3   23   59   58  999990             -2
    1969-12-31T23:59:58.999998             -1000002 1969   12    1  365   31    3   23   59   58  999998             -2
    1969-12-31T23:59:58.999999             -1000001 1969   12    1  365   31    3   23   59   58  999999             -2
    1969-12-31T23:59:59.000000             -1000000 1969   12    1  365   31    3   23   59   59       0             -1
    1969-12-31T23:59:59.000001              -999999 1969   12    1  365   31    3   23   59   59       1             -1
    1969-12-31T23:59:59.000002              -999998 1969   12    1  365   31    3   23   59   59       2             -1
    1969-12-31T23:59:59.000010              -999990 1969   12    1  365   31    3   23   59   59      10             -1
    1969-12-31T23:59:59.000020              -999980 1969   12    1  365   31    3   23   59   59      20             -1
    1969-12-31T23:59:59.000100              -999900 1969   12    1  365   31    3   23   59   59     100             -1
    1969-12-31T23:59:59.000200              -999800 1969   12    1  365   31    3   23   59   59     200             -1
    1969-12-31T23:59:59.001000              -999000 1969   12    1  365   31    3   23   59   59    1000             -1
    1969-12-31T23:59:59.002000              -998000 1969   12    1  365   31    3   23   59   59    2000             -1
    1969-12-31T23:59:59.010000              -990000 1969   12    1  365   31    3   23   59   59   10000             -1
    1969-12-31T23:59:59.020000              -980000 1969   12    1  365   31    3   23   59   59   20000             -1
    1969-12-31T23:59:59.100000              -900000 1969   12    1  365   31    3   23   59   59  100000             -1
    1969-12-31T23:59:59.200000              -800000 1969   12    1  365   31    3   23   59   59  200000             -1
    1969-12-31T23:59:59.300000              -700000 1969   12    1  365   31    3   23   59   59  300000             -1
    1969-12-31T23:59:59.400000              -600000 1969   12    1  365   31    3   23   59   59  400000             -1
    1969-12-31T23:59:59.490000              -510000 1969   12    1  365   31    3   23   59   59  490000             -1
    1969-12-31T23:59:59.499000              -501000 1969   12    1  365   31    3   23   59   59  499000             -1
    1969-12-31T23:59:59.499900              -500100 1969   12    1  365   31    3   23   59   59  499900             -1
    1969-12-31T23:59:59.499990              -500010 1969   12    1  365   31    3   23   59   59  499990             -1
    1969-12-31T23:59:59.499999              -500001 1969   12    1  365   31    3   23   59   59  499999             -1
    1969-12-31T23:59:59.500000              -500000 1969   12    1  365   31    3   23   59   59  500000             -1
    1969-12-31T23:59:59.500001              -499999 1969   12    1  365   31    3   23   59   59  500001             -1
    1969-12-31T23:59:59.500010              -499990 1969   12    1  365   31    3   23   59   59  500010             -1
    1969-12-31T23:59:59.500100              -499900 1969   12    1  365   31    3   23   59   59  500100             -1
    1969-12-31T23:59:59.501000              -499000 1969   12    1  365   31    3   23   59   59  501000             -1
    1969-12-31T23:59:59.510000              -490000 1969   12    1  365   31    3   23   59   59  510000             -1
    1969-12-31T23:59:59.600000              -400000 1969   12    1  365   31    3   23   59   59  600000             -1
    1969-12-31T23:59:59.700000              -300000 1969   12    1  365   31    3   23   59   59  700000             -1
    1969-12-31T23:59:59.800000              -200000 1969   12    1  365   31    3   23   59   59  800000             -1
    1969-12-31T23:59:59.900000              -100000 1969   12    1  365   31    3   23   59   59  900000             -1
    1969-12-31T23:59:59.980000               -20000 1969   12    1  365   31    3   23   59   59  980000             -1
    1969-12-31T23:59:59.990000               -10000 1969   12    1  365   31    3   23   59   59  990000             -1
    1969-12-31T23:59:59.998000                -2000 1969   12    1  365   31    3   23   59   59  998000             -1
    1969-12-31T23:59:59.999000                -1000 1969   12    1  365   31    3   23   59   59  999000             -1
    1969-12-31T23:59:59.999800                 -200 1969   12    1  365   31    3   23   59   59  999800             -1
    1969-12-31T23:59:59.999900                 -100 1969   12    1  365   31    3   23   59   59  999900             -1
    1969-12-31T23:59:59.999980                  -20 1969   12    1  365   31    3   23   59   59  999980             -1
    1969-12-31T23:59:59.999990                  -10 1969   12    1  365   31    3   23   59   59  999990             -1
    1969-12-31T23:59:59.999998                   -2 1969   12    1  365   31    3   23   59   59  999998             -1
    1969-12-31T23:59:59.999999                   -1 1969   12    1  365   31    3   23   59   59  999999             -1
    1970-01-01T00:00:00.000000                    0 1970    1    1    1    1    4    0    0    0       0              0
    1970-01-01T00:00:00.000001                    1 1970    1    1    1    1    4    0    0    0       1              0
    1970-01-01T00:00:00.000002                    2 1970    1    1    1    1    4    0    0    0       2              0
    1970-01-01T00:00:00.000010                   10 1970    1    1    1    1    4    0    0    0      10              0
    1970-01-01T00:00:00.000020                   20 1970    1    1    1    1    4    0    0    0      20              0
    1970-01-01T00:00:00.000100                  100 1970    1    1    1    1    4    0    0    0     100              0
    1970-01-01T00:00:00.000200                  200 1970    1    1    1    1    4    0    0    0     200              0
    1970-01-01T00:00:00.001000                 1000 1970    1    1    1    1    4    0    0    0    1000              0
    1970-01-01T00:00:00.002000                 2000 1970    1    1    1    1    4    0    0    0    2000              0
    1970-01-01T00:00:00.010000                10000 1970    1    1    1    1    4    0    0    0   10000              0
    1970-01-01T00:00:00.020000                20000 1970    1    1    1    1    4    0    0    0   20000              0
    1970-01-01T00:00:00.100000               100000 1970    1    1    1    1    4    0    0    0  100000              0
    1970-01-01T00:00:00.200000               200000 1970    1    1    1    1    4    0    0    0  200000              0
    1970-01-01T00:00:00.300000               300000 1970    1    1    1    1    4    0    0    0  300000              0
    1970-01-01T00:00:00.400000               400000 1970    1    1    1    1    4    0    0    0  400000              0
    1970-01-01T00:00:00.490000               490000 1970    1    1    1    1    4    0    0    0  490000              0
    1970-01-01T00:00:00.499000               499000 1970    1    1    1    1    4    0    0    0  499000              0
    1970-01-01T00:00:00.499900               499900 1970    1    1    1    1    4    0    0    0  499900              0
    1970-01-01T00:00:00.499990               499990 1970    1    1    1    1    4    0    0    0  499990              0
    1970-01-01T00:00:00.499999               499999 1970    1    1    1    1    4    0    0    0  499999              0
    1970-01-01T00:00:00.500000               500000 1970    1    1    1    1    4    0    0    0  500000              0
    1970-01-01T00:00:00.500001               500001 1970    1    1    1    1    4    0    0    0  500001              0
    1970-01-01T00:00:00.500010               500010 1970    1    1    1    1    4    0    0    0  500010              0
    1970-01-01T00:00:00.500100               500100 1970    1    1    1    1    4    0    0    0  500100              0
    1970-01-01T00:00:00.501000               501000 1970    1    1    1    1    4    0    0    0  501000              0
    1970-01-01T00:00:00.510000               510000 1970    1    1    1    1    4    0    0    0  510000              0
    1970-01-01T00:00:00.600000               600000 1970    1    1    1    1    4    0    0    0  600000              0
    1970-01-01T00:00:00.700000               700000 1970    1    1    1    1    4    0    0    0  700000              0
    1970-01-01T00:00:00.800000               800000 1970    1    1    1    1    4    0    0    0  800000              0
    1970-01-01T00:00:00.900000               900000 1970    1    1    1    1    4    0    0    0  900000              0
    1970-01-01T00:00:00.980000               980000 1970    1    1    1    1    4    0    0    0  980000              0
    1970-01-01T00:00:00.990000               990000 1970    1    1    1    1    4    0    0    0  990000              0
    1970-01-01T00:00:00.999800               999800 1970    1    1    1    1    4    0    0    0  999800              0
    1970-01-01T00:00:00.999900               999900 1970    1    1    1    1    4    0    0    0  999900              0
    1970-01-01T00:00:00.999980               999980 1970    1    1    1    1    4    0    0    0  999980              0
    1970-01-01T00:00:00.999990               999990 1970    1    1    1    1    4    0    0    0  999990              0
    1970-01-01T00:00:00.999998               999998 1970    1    1    1    1    4    0    0    0  999998              0
    1970-01-01T00:00:00.999999               999999 1970    1    1    1    1    4    0    0    0  999999              0
    1970-01-01T00:00:01.000000              1000000 1970    1    1    1    1    4    0    0    1       0              1
    1970-01-01T00:00:01.000001              1000001 1970    1    1    1    1    4    0    0    1       1              1
    1970-01-01T00:00:01.000002              1000002 1970    1    1    1    1    4    0    0    1       2              1
    1970-01-01T00:00:01.000010              1000010 1970    1    1    1    1    4    0    0    1      10              1
    1970-01-01T00:00:01.000020              1000020 1970    1    1    1    1    4    0    0    1      20              1
    1970-01-01T00:00:01.000100              1000100 1970    1    1    1    1    4    0    0    1     100              1
    1970-01-01T00:00:01.000200              1000200 1970    1    1    1    1    4    0    0    1     200              1
    1970-01-01T00:00:01.001000              1001000 1970    1    1    1    1    4    0    0    1    1000              1
    1970-01-01T00:00:01.002000              1002000 1970    1    1    1    1    4    0    0    1    2000              1
    1970-01-01T00:00:01.010000              1010000 1970    1    1    1    1    4    0    0    1   10000              1
    1970-01-01T00:00:01.020000              1020000 1970    1    1    1    1    4    0    0    1   20000              1
    1970-01-01T00:00:01.100000              1100000 1970    1    1    1    1    4    0    0    1  100000              1
    1970-01-01T00:00:01.200000              1200000 1970    1    1    1    1    4    0    0    1  200000              1
    9999-12-31T23:59:58.000000   253402300798000000 9999   12   52  365   31    5   23   59   58       0   253402300798
    9999-12-31T23:59:58.500000   253402300798500000 9999   12   52  365   31    5   23   59   58  500000   253402300798
    9999-12-31T23:59:58.800000   253402300798800000 9999   12   52  365   31    5   23   59   58  800000   253402300798
    9999-12-31T23:59:58.900000   253402300798900000 9999   12   52  365   31    5   23   59   58  900000   253402300798
    9999-12-31T23:59:58.980000   253402300798980000 9999   12   52  365   31    5   23   59   58  980000   253402300798
    9999-12-31T23:59:58.990000   253402300798990000 9999   12   52  365   31    5   23   59   58  990000   253402300798
    9999-12-31T23:59:58.998000   253402300798998000 9999   12   52  365   31    5   23   59   58  998000   253402300798
    9999-12-31T23:59:58.999000   253402300798999000 9999   12   52  365   31    5   23   59   58  999000   253402300798
    9999-12-31T23:59:58.999800   253402300798999800 9999   12   52  365   31    5   23   59   58  999800   253402300798
    9999-12-31T23:59:58.999900   253402300798999900 9999   12   52  365   31    5   23   59   58  999900   253402300798
    9999-12-31T23:59:58.999980   253402300798999980 9999   12   52  365   31    5   23   59   58  999980   253402300798
    9999-12-31T23:59:58.999990   253402300798999990 9999   12   52  365   31    5   23   59   58  999990   253402300798
    9999-12-31T23:59:58.999998   253402300798999998 9999   12   52  365   31    5   23   59   58  999998   253402300798
    9999-12-31T23:59:58.999999   253402300798999999 9999   12   52  365   31    5   23   59   58  999999   253402300798
    9999-12-31T23:59:59.000000   253402300799000000 9999   12   52  365   31    5   23   59   59       0   253402300799
    9999-12-31T23:59:59.000001   253402300799000001 9999   12   52  365   31    5   23   59   59       1   253402300799
    9999-12-31T23:59:59.000002   253402300799000002 9999   12   52  365   31    5   23   59   59       2   253402300799
    9999-12-31T23:59:59.000010   253402300799000010 9999   12   52  365   31    5   23   59   59      10   253402300799
    9999-12-31T23:59:59.000020   253402300799000020 9999   12   52  365   31    5   23   59   59      20   253402300799
    9999-12-31T23:59:59.000100   253402300799000100 9999   12   52  365   31    5   23   59   59     100   253402300799
    9999-12-31T23:59:59.000200   253402300799000200 9999   12   52  365   31    5   23   59   59     200   253402300799
    9999-12-31T23:59:59.001000   253402300799001000 9999   12   52  365   31    5   23   59   59    1000   253402300799
    9999-12-31T23:59:59.002000   253402300799002000 9999   12   52  365   31    5   23   59   59    2000   253402300799
    9999-12-31T23:59:59.010000   253402300799010000 9999   12   52  365   31    5   23   59   59   10000   253402300799
    9999-12-31T23:59:59.020000   253402300799020000 9999   12   52  365   31    5   23   59   59   20000   253402300799
    9999-12-31T23:59:59.100000   253402300799100000 9999   12   52  365   31    5   23   59   59  100000   253402300799
    9999-12-31T23:59:59.200000   253402300799200000 9999   12   52  365   31    5   23   59   59  200000   253402300799
    9999-12-31T23:59:59.300000   253402300799300000 9999   12   52  365   31    5   23   59   59  300000   253402300799
    9999-12-31T23:59:59.400000   253402300799400000 9999   12   52  365   31    5   23   59   59  400000   253402300799
    9999-12-31T23:59:59.490000   253402300799490000 9999   12   52  365   31    5   23   59   59  490000   253402300799
    9999-12-31T23:59:59.499000   253402300799499000 9999   12   52  365   31    5   23   59   59  499000   253402300799
    9999-12-31T23:59:59.499900   253402300799499900 9999   12   52  365   31    5   23   59   59  499900   253402300799
    9999-12-31T23:59:59.499990   253402300799499990 9999   12   52  365   31    5   23   59   59  499990   253402300799
    9999-12-31T23:59:59.499999   253402300799499999 9999   12   52  365   31    5   23   59   59  499999   253402300799
    9999-12-31T23:59:59.500000   253402300799500000 9999   12   52  365   31    5   23   59   59  500000   253402300799
    9999-12-31T23:59:59.500001   253402300799500001 9999   12   52  365   31    5   23   59   59  500001   253402300799
    9999-12-31T23:59:59.500010   253402300799500010 9999   12   52  365   31    5   23   59   59  500010   253402300799
    9999-12-31T23:59:59.500100   253402300799500100 9999   12   52  365   31    5   23   59   59  500100   253402300799
    9999-12-31T23:59:59.501000   253402300799501000 9999   12   52  365   31    5   23   59   59  501000   253402300799
    9999-12-31T23:59:59.510000   253402300799510000 9999   12   52  365   31    5   23   59   59  510000   253402300799
    9999-12-31T23:59:59.600000   253402300799600000 9999   12   52  365   31    5   23   59   59  600000   253402300799
    9999-12-31T23:59:59.700000   253402300799700000 9999   12   52  365   31    5   23   59   59  700000   253402300799
    9999-12-31T23:59:59.800000   253402300799800000 9999   12   52  365   31    5   23   59   59  800000   253402300799
    9999-12-31T23:59:59.900000   253402300799900000 9999   12   52  365   31    5   23   59   59  900000   253402300799
    9999-12-31T23:59:59.980000   253402300799980000 9999   12   52  365   31    5   23   59   59  980000   253402300799
    9999-12-31T23:59:59.990000   253402300799990000 9999   12   52  365   31    5   23   59   59  990000   253402300799
    9999-12-31T23:59:59.998000   253402300799998000 9999   12   52  365   31    5   23   59   59  998000   253402300799
    9999-12-31T23:59:59.999000   253402300799999000 9999   12   52  365   31    5   23   59   59  999000   253402300799
    9999-12-31T23:59:59.999800   253402300799999800 9999   12   52  365   31    5   23   59   59  999800   253402300799
    9999-12-31T23:59:59.999900   253402300799999900 9999   12   52  365   31    5   23   59   59  999900   253402300799
    9999-12-31T23:59:59.999980   253402300799999980 9999   12   52  365   31    5   23   59   59  999980   253402300799
    9999-12-31T23:59:59.999990   253402300799999990 9999   12   52  365   31    5   23   59   59  999990   253402300799
    9999-12-31T23:59:59.999998   253402300799999998 9999   12   52  365   31    5   23   59   59  999998   253402300799
    9999-12-31T23:59:59.999999   253402300799999999 9999   12   52  365   31    5   23   59   59  999999   253402300799
    0400-02-28T12:12:12.500000   -49539383267500000  400    2    9   59   28    1   12   12   12  500000   -49539383268
    0400-02-29T12:12:12.500000   -49539296867500000  400    2    9   60   29    2   12   12   12  500000   -49539296868
    0400-03-01T12:12:12.500000   -49539210467500000  400    3    9   61    1    3   12   12   12  500000   -49539210468
    0400-12-31T12:12:12.500000   -49512858467500000  400   12   52  366   31    7   12   12   12  500000   -49512858468
    0500-02-28T12:12:12.500000   -46383623267500000  500    2    8   59   28    7   12   12   12  500000   -46383623268
    0500-03-01T12:12:12.500000   -46383536867500000  500    3    9   60    1    1   12   12   12  500000   -46383536868
    0500-12-31T12:12:12.500000   -46357184867500000  500   12   52  365   31    5   12   12   12  500000   -46357184868
    1000-02-28T12:12:12.500000   -30605168867500000 1000    2    9   59   28    5   12   12   12  500000   -30605168868
    1000-03-01T12:12:12.500000   -30605082467500000 1000    3    9   60    1    6   12   12   12  500000   -30605082468
    1000-12-31T12:12:12.500000   -30578730467500000 1000   12    1  365   31    3   12   12   12  500000   -30578730468
    1500-02-28T12:12:12.500000   -14826714467500000 1500    2    9   59   28    3   12   12   12  500000   -14826714468
    1500-03-01T12:12:12.500000   -14826628067500000 1500    3    9   60    1    4   12   12   12  500000   -14826628068
    1500-12-31T12:12:12.500000   -14800276067500000 1500   12    1  365   31    1   12   12   12  500000   -14800276068
    1600-02-28T12:12:12.500000   -11671040867500000 1600    2    9   59   28    1   12   12   12  500000   -11671040868
    1600-02-29T12:12:12.500000   -11670954467500000 1600    2    9   60   29    2   12   12   12  500000   -11670954468
    1600-03-01T12:12:12.500000   -11670868067500000 1600    3    9   61    1    3   12   12   12  500000   -11670868068
    1600-12-31T12:12:12.500000   -11644516067500000 1600   12   52  366   31    7   12   12   12  500000   -11644516068
    2000-02-28T12:12:12.500000      951739932500000 2000    2    9   59   28    1   12   12   12  500000      951739932
    2000-02-29T12:12:12.500000      951826332500000 2000    2    9   60   29    2   12   12   12  500000      951826332
    2000-03-01T12:12:12.500000      951912732500000 2000    3    9   61    1    3   12   12   12  500000      951912732
    2000-12-31T12:12:12.500000      978264732500000 2000   12   52  366   31    7   12   12   12  500000      978264732
    3000-02-28T12:12:12.500000    32508735132500000 3000    2    9   59   28    5   12   12   12  500000    32508735132
    3000-03-01T12:12:12.500000    32508821532500000 3000    3    9   60    1    6   12   12   12  500000    32508821532
    3000-12-31T12:12:12.500000    32535173532500000 3000   12    1  365   31    3   12   12   12  500000    32535173532
    4000-02-28T12:12:12.500000    64065643932500000 4000    2    9   59   28    1   12   12   12  500000    64065643932
    4000-02-29T12:12:12.500000    64065730332500000 4000    2    9   60   29    2   12   12   12  500000    64065730332
    4000-03-01T12:12:12.500000    64065816732500000 4000    3    9   61    1    3   12   12   12  500000    64065816732
    4000-12-31T12:12:12.500000    64092168732500000 4000   12   52  366   31    7   12   12   12  500000    64092168732
    9600-02-28T12:12:12.500000   240784575132500000 9600    2    9   59   28    1   12   12   12  500000   240784575132
    9600-02-29T12:12:12.500000   240784661532500000 9600    2    9   60   29    2   12   12   12  500000   240784661532
    9600-03-01T12:12:12.500000   240784747932500000 9600    3    9   61    1    3   12   12   12  500000   240784747932
    9600-12-31T12:12:12.500000   240811099932500000 9600   12   52  366   31    7   12   12   12  500000   240811099932
/);

my @datetime;
my @epoch_us;
my @year;
my @month;
my @week;
my @day_of_year;
my @day_of_month;
my @day_of_week;
my @hour;
my @minute;
my @second;
my @microsecond;
my @epoch;

while (@data) {
  push @datetime    , shift(@data);
  push @epoch_us    , int(shift(@data));
  push @year        , int(shift(@data));
  push @month       , int(shift(@data));
  push @week        , int(shift(@data));
  push @day_of_year , int(shift(@data));
  push @day_of_month, int(shift(@data));
  push @day_of_week , int(shift(@data));
  push @hour        , int(shift(@data));
  push @minute      , int(shift(@data));
  push @second      , int(shift(@data));
  push @microsecond , int(shift(@data));
  push @epoch       , int(shift(@data));
}

my $pdl_epoch_us      = longlong(\@epoch_us    );
my $pdl_year          =     long(\@year        );
my $pdl_month         =     long(\@month       );
my $pdl_week          =     long(\@week        );
my $pdl_day_of_year   =     long(\@day_of_year );
my $pdl_day_of_month  =     long(\@day_of_month);
my $pdl_day_of_week   =     long(\@day_of_week );
my $pdl_hour          =     long(\@hour        );
my $pdl_minute        =     long(\@minute      );
my $pdl_second        =     long(\@second      );
my $pdl_microsecond   =     long(\@microsecond );
my $pdl_epoch         = longlong(\@epoch       );

my $dt1 = PDL::DateTime->new_from_datetime(\@datetime);
my $dt2 = PDL::DateTime->new_from_parts(\@year, \@month, \@day_of_month, \@hour, \@minute, \@second, \@microsecond);
my $dt3 = PDL::DateTime->new_from_parts($pdl_year, $pdl_month, $pdl_day_of_month, $pdl_hour, $pdl_minute, $pdl_second, $pdl_microsecond);
my $dt4 = PDL::DateTime->new_from_ymd($pdl_year*10000 + $pdl_month*100 + $pdl_day_of_month);

ok(all($dt1 == $dt2),                                      'compare dt/array');
ok(all($dt1 == $dt3),                                      'compare dt/pdl');
ok(all($dt1->dt_truncate('day') == $dt4),                  'compare dt/ymd');
my ($y, $m, $d) = $dt1->dt_ymd;
ok(all($y == $pdl_year),                                   'part year');
ok(all($m == $pdl_month),                                  'part month');
ok(all($d == $pdl_day_of_month),                           'part day_of_month');
ok(all($dt1->dt_day_of_week == $pdl_day_of_week),          'part day_of_week');
ok(all($dt1->dt_day_of_year == $pdl_day_of_year),          'part day_of_year');
ok(all($dt1->dt_hour == $pdl_hour),                        'part hour');
ok(all($dt1->dt_minute == $pdl_minute),                    'part minute');
ok(all($dt1->dt_second == $pdl_second),                    'part second');
ok(all($dt1->dt_microsecond == $pdl_microsecond),          'part microsecond');
ok(all(longlong(floor($dt1->double_epoch)) == $pdl_epoch), 'epoch');

done_testing();
